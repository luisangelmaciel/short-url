(function () {

  // Helpers
  const qsa = document.querySelectorAll.bind(document)

  // Avoid FOUC
  ;[].forEach.call(
  qsa('[hidden]'),
  icon => icon.removeAttribute('hidden'));


  // Cache DOM elements
  const icons = qsa('.c-icon');
  const syringes = qsa('.c-icon__syringe');
  const stems = qsa('.c-icon__stem');
  const peaks = qsa('.c-icon__peak');
  const fluids = qsa('.c-icon__fluid');
  const drops = qsa('.c-icon__drop');
  const types = qsa('.c-icon__type');

  const dropPath = [{ "x": 0.05001159667969546, "y": 0.030000076293944744 }, { "x": 0.12001159667968864, "y": 5.290000076293943 }, { "x": 0.30001159667969546, "y": 10.550000076293944 }, { "x": 0.5200115966796943, "y": 15.810000076293946 }, { "x": 0.7400115966796932, "y": 21.000000076293944 }, { "x": 1.1000115966797068, "y": 26.19000007629395 }, { "x": 1.1900115966796818, "y": 31.380000076293946 }, { "x": 1.2700115966796943, "y": 36.420000076293945 }, { "x": 1.180011596679691, "y": 41.61000007629394 }, { "x": 0.05001159667969546, "y": 46.54000007629395 }, { "x": -0.9199884033203034, "y": 50.800000076293955 }, { "x": -2.759988403320307, "y": 54.86000007629394 }, { "x": -5.529988403320317, "y": 58.25000007629396 }, { "x": -8.579988403320328, "y": 61.98000007629396 }, { "x": -12.499988403320316, "y": 64.63000007629395 }, { "x": -16.499988403320316, "y": 67.22000007629396 }, { "x": -20.189988403320314, "y": 69.60000007629395 }, { "x": -23.309988403320318, "y": 72.78000007629396 }, { "x": -25.689988403320314, "y": 76.47000007629396 }, { "x": -26.389988403320316, "y": 77.55000007629395 }, { "x": -27.169988403320318, "y": 78.60000007629395 }, { "x": -27.749988403320316, "y": 79.76000007629396 }, { "x": -28.25998840332032, "y": 80.78000007629396 }, { "x": -28.59998840332031, "y": 81.87000007629396 }, { "x": -28.97998840332032, "y": 82.94000007629397 }, { "x": -29.389988403320316, "y": 84.06000007629397 }, { "x": -29.86998840332032, "y": 85.15000007629396 }, { "x": -30.14998840332032, "y": 86.31000007629397 }, { "x": -30.44998840332032, "y": 87.53000007629397 }, { "x": -30.549988403320327, "y": 88.79000007629398 }, { "x": -30.739988403320325, "y": 90.04000007629398 }, { "x": -32.239988403320325, "y": 99.74000007629398 }, { "x": -28.49998840332033, "y": 109.94000007629398 }, { "x": -21.559988403320318, "y": 116.79000007629398 }, { "x": -19.959988403320324, "y": 118.37000007629399 }, { "x": -18.00998840332032, "y": 119.89000007629397 }, { "x": -16.039988403320308, "y": 120.97000007629399 }, { "x": -14.069988403320309, "y": 122.050000076294 }, { "x": -11.929988403320294, "y": 123.23000007629398 }, { "x": -9.749988403320316, "y": 123.830000076294 }, { "x": -7.399988403320322, "y": 124.47000007629399 }, { "x": -5.039988403320308, "y": 125.06000007629399 }, { "x": -2.6099884033203296, "y": 125.240000076294 }, { "x": -0.08998840332031932, "y": 125.420000076294 }, { "x": 2.310011596679658, "y": 125.260000076294 }, { "x": 4.790011596679676, "y": 124.790000076294 }, { "x": 7.1400115966796704, "y": 124.35000007629401 }, { "x": 9.300011596679667, "y": 123.610000076294 }, { "x": 11.540011596679676, "y": 122.770000076294 }, { "x": 13.86001159667967, "y": 121.90000007629399 }, { "x": 15.86001159667967, "y": 120.50000007629399 }, { "x": 17.87001159667969, "y": 119.080000076294 }, { "x": 19.730011596679702, "y": 117.770000076294 }, { "x": 21.460011596679692, "y": 115.88000007629401 }, { "x": 22.840011596679688, "y": 114.080000076294 }, { "x": 24.210011596679692, "y": 112.31000007629399 }, { "x": 25.530011596679685, "y": 110.32000007629401 }, { "x": 26.470011596679683, "y": 108.29000007629399 }, { "x": 30.62001159667969, "y": 99.300000076294 }, { "x": 29.560011596679686, "y": 88.410000076294 }, { "x": 23.980011596679674, "y": 80.270000076294 }, { "x": 21.41001159667968, "y": 76.530000076294 }, { "x": 17.790011596679676, "y": 73.470000076294 }, { "x": 13.700011596679673, "y": 71.550000076294 }, { "x": 11.41001159667968, "y": 70.470000076294 }, { "x": 9.200011596679673, "y": 69.730000076294 }, { "x": 6.730011596679674, "y": 69.160000076294 }, { "x": 4.3900115966796704, "y": 68.62000007629399 }, { "x": 1.7800115966796852, "y": 68.660000076294 }, { "x": -0.6099884033203296, "y": 68.860000076294 }, { "x": -10.279988403320317, "y": 69.670000076294 }, { "x": -18.809988403320332, "y": 76.070000076294 }, { "x": -22.32998840332033, "y": 85.110000076294 }, { "x": -25.839988403320334, "y": 94.110000076294 }, { "x": -23.669988403320332, "y": 104.990000076294 }, { "x": -16.569988403320338, "y": 111.65000007629399 }, { "x": -12.969988403320343, "y": 115.03000007629399 }, { "x": -8.709988403320324, "y": 117.080000076294 }, { "x": -3.87998840332034, "y": 117.950000076294 }, { "x": 1.0400115966796477, "y": 118.84000007629399 }, { "x": 6.540011596679648, "y": 117.790000076294 }, { "x": 10.86001159667967, "y": 115.28000007629402 }, { "x": 18.970011596679683, "y": 110.57000007629401 }, { "x": 23.930011596679662, "y": 100.62000007629402 }, { "x": 21.36001159667967, "y": 91.34000007629402 }, { "x": 20.720011596679683, "y": 89.04000007629402 }, { "x": 19.810011596679658, "y": 86.76000007629402 }, { "x": 18.510011596679675, "y": 84.75000007629401 }, { "x": 17.230011596679674, "y": 82.76000007629402 }, { "x": 15.470011596679683, "y": 81.17000007629402 }, { "x": 13.63001159667968, "y": 79.72000007629401 }, { "x": 9.870011596679689, "y": 76.76000007629402 }, { "x": 4.910011596679681, "y": 75.43000007629401 }, { "x": 0.14001159667967045, "y": 75.790000076294 }, { "x": -4.579988403320328, "y": 76.150000076294 }, { "x": -9.13998840332033, "y": 78.540000076294 }, { "x": -12.249988403320344, "y": 82.05000007629401 }, { "x": -15.479988403320334, "y": 85.70000007629402 }, { "x": -17.12998840332034, "y": 90.38000007629401 }, { "x": -16.89998840332035, "y": 95.27000007629401 }, { "x": -16.479988403320363, "y": 104.010000076294 }, { "x": -8.87998840332034, "y": 111.330000076294 }, { "x": -0.09998840332033865, "y": 111.19000007629401 }, { "x": 4.210011596679664, "y": 111.12000007629402 }, { "x": 8.180011596679662, "y": 109.30000007629401 }, { "x": 11.12001159667966, "y": 106.150000076294 }, { "x": 14.060011596679658, "y": 103.010000076294 }, { "x": 15.500011596679656, "y": 98.000000076294 }, { "x": 14.700011596679673, "y": 93.780000076294 }, { "x": 13.91001159667968, "y": 89.580000076294 }, { "x": 11.190011596679682, "y": 85.980000076294 }, { "x": 7.330011596679668, "y": 84.150000076294 }, { "x": 3.4000115966796614, "y": 82.280000076294 }, { "x": -1.4699884033203432, "y": 82.49000007629401 }, { "x": -5.089988403320319, "y": 84.980000076294 }, { "x": -8.289988403320308, "y": 87.18000007629401 }, { "x": -10.169988403320332, "y": 91.13000007629401 }, { "x": -9.85998840332033, "y": 95.000000076294 }, { "x": -9.559988403320318, "y": 98.750000076294 }, { "x": -7.059988403320318, "y": 102.300000076294 }, { "x": -3.499988403320316, "y": 103.620000076294 }, { "x": -0.07998840332032842, "y": 104.88000007629401 }, { "x": 3.980011596679674, "y": 103.80000007629401 }, { "x": 6.260011596679675, "y": 100.93000007629401 }, { "x": 8.480011596679674, "y": 98.13000007629401 }, { "x": 8.450011596679673, "y": 94.08000007629401 }, { "x": 5.820011596679677, "y": 91.57000007629401 }, { "x": 3.3800115966796795, "y": 89.24000007629401 }, { "x": -1.0199884033203261, "y": 89.05000007629401 }, { "x": -2.5799884033203284, "y": 92.530000076294 }, { "x": -3.279988403320317, "y": 94.100000076294 }, { "x": -3.019988403320326, "y": 96.200000076294 }, { "x": -1.3399884033203193, "y": 97.030000076294 }, { "x": -0.529988403320317, "y": 97.43000007629401 }, { "x": 0.6200115966796886, "y": 97.420000076294 }, { "x": 1.1200115966796886, "y": 96.57000007629401 }, { "x": 1.4100115966796807, "y": 96.090000076294 }, { "x": 1.4900115966796932, "y": 95.260000076294 }, { "x": 0.7300115966797023, "y": 95.24000007629401 }];

  // Set properties
  TweenMax.set(syringes, {
    transformOrigin: 'center',
    x: 4.1,
    y: 1.5,
    rotation: 45 });

  TweenMax.set(drops, {
    transformOrigin: 'center top',
    xPercent: -50,
    yPercent: -50,
    opacity: 0,
    scale: .2 });

  TweenMax.set(types, {
    transformOrigin: 'center',
    scale: .8,
    opacity: .6 })


  // Timeline
  ;[].forEach.call(icons, icon => {
    const syringes = icon.querySelectorAll('.c-icon__syringe');
    const stems = icon.querySelectorAll('.c-icon__stem');
    const peaks = icon.querySelectorAll('.c-icon__peak');
    const fluids = icon.querySelectorAll('.c-icon__fluid');
    const drops = icon.querySelectorAll('.c-icon__drop');
    const types = icon.querySelectorAll('.c-icon__type');

    const tl = new TimelineMax({
      repeat: -1,
      repeatDelay: 1
      // delay: Math.round(Math.random() * 10)
    });

    tl.to(stems, 1, { scaleY: .85 });
    tl.to(fluids, 1, { scaleY: .7 }, '-=1');
    tl.to(peaks, 1, { y: '-=19' }, '-=1');

    tl.staggerTo(drops, .6, {
      scale: 1,
      opacity: 1 },
    .3, '-=.8');

    tl.staggerTo(drops, 3, {
      transformOrigin: 'center',
      bezier: {
        type: 'cubic',
        values: dropPath,
        autoRotate: -90 },

      scale: .2,
      opacity: 0,
      ease: Power1.easeIn },
    .3, '-=.9');

    tl.to(types, 3, {
      scale: 1,
      opacity: 1,
      ease: Power1.easeOut },
    '-=2.1');

    tl.to(types, .6, {
      scale: .8,
      opacity: .6,
      delay: 1 });


    tl.to([stems, fluids], 1, { scaleY: 1 }, '-=.6');
    tl.to(peaks, 1, { y: 0 }, '-=1');
  });

})();